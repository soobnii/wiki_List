
# tar -xzvf : tar.gz 파일 압축 풀기 (압축할 땐 tar -cvf [파일명.tar] [압축할 폴더명] , -c : 파일을 tar 로 압축)
# x : tar 압축 해제 / z : gzip으로 압축하거나 해제 / v : 압축,해제의 과정을 화면으로 출력 / f : 파일 이름 지정 
# rm : 파일 및 디렉토리 삭제 - 압축 해제 후  ./apache-tomcat-8.5.56.tar.gz 파일은 삭제 
# mv : 파일 이동 - ./apache-tomcat-8.5.56 를 /opt 폴더 하위로 이동 
# ln : 링크파일 만드는 명령어 
# -s [원본파일 디렉토리] [심볼릭 링크(바로가기) 경로 및 이름] 
# -f : 동일 링크파일 있을 경우, 기존 파일 지우고 새로 생성 
# chmod : 접근 권한 변경 명령어 
# +x : 모든 소유자에게 실행 권한 추가(여기선 해당 경로의 모든 sh 확장자에 대한 실행권한)
RUN chmod +x ${CATALINA_HOME}/bin/*.sh

###### 리눅스 권한 분류 (3자리 숫자 - 소유자권한/그룹사용자권한/기타사용자권한)

# 읽기:4, 쓰기:2, 실행 :1 -> 7은 모든 권한 부여 
# 755는 소유자만 모든것이 가능하고, 그 외 사용자는 읽기, 실행은 가능하나 쓰기 불가 

# 호스트와 연결할 포트 설정
# 여기서 설정한 포트는 호스트와 연결할 뿐, 외부에 노출하려면 docker run 에서 옵션 이용 
EXPOSE 8080

# docker run 실행 시, 실행될 default 명령어 설정 : CMD ['실행파일', '매개변수'..] 
# CMD 는 도커파일에서 한번만 사용 가능 -> 여러개일 경우 ENTRYPOINT 명령어(docker run 시 명령어로 대체안됨) 이용, entrypoint.sh 실행  
# 톰캣 구동 (설정파일)
CMD ["catalina.sh", "run"]

# 이클립스 압축파일 다운 및 해제 (-C /opt : opt 폴더에 압축 해제)
RUN wget http://ftp.jaist.ac.jp/pub/eclipse/technology/epp/downloads/release/2020-06/R/eclipse-jee-2020-06-R-linux-gtk-x86_64.tar.gz && \
       tar -zxvf eclipse-jee-2020-06-R-linux-gtk-x86_64.tar.gz -C /opt && \
       ln -sf /opt/eclipse /usr/bin/eclipse

# Openshift의 Pod 내에서 User는 임의의 숫자 형태
# 사용자 계정 변경 (B/C 오픈시프트에서 이미지 실행 시 root(0) 유저의 사용이 제한되기 때문에 권한 문제 발생 ) 
USER 100100
  
